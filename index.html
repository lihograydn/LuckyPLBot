<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mCoin Games</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a0f;
            --bg-card: #12121a;
            --bg-elevated: #1a1a25;
            --fg: #e8e8ed;
            --muted: #6b6b7a;
            --accent: #f0b429;
            --accent-glow: rgba(240, 180, 41, 0.3);
            --danger: #ef4444;
            --success: #22c55e;
            --border: #2a2a3a;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: var(--bg);
            color: var(--fg);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        .bg-pattern {
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(ellipse 80% 50% at 50% -20%, rgba(240, 180, 41, 0.08), transparent),
                radial-gradient(ellipse 60% 40% at 80% 100%, rgba(240, 180, 41, 0.05), transparent),
                linear-gradient(180deg, var(--bg) 0%, #0d0d14 100%);
            pointer-events: none;
            z-index: -1;
        }

        .grid-overlay {
            position: fixed;
            inset: 0;
            background-image: 
                linear-gradient(rgba(255,255,255,0.015) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.015) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: -1;
        }

        .nav-item {
            position: relative;
            padding: 0.75rem 1.25rem;
            color: var(--muted);
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 10px;
        }

        .nav-item:hover {
            color: var(--fg);
            background: rgba(255,255,255,0.05);
        }

        .nav-item.active {
            color: var(--accent);
            background: rgba(240, 180, 41, 0.1);
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.2s ease;
            cursor: pointer;
            border: none;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent), #d4a020);
            color: #0a0a0f;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--accent-glow);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: var(--bg-elevated);
            color: var(--fg);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover:not(:disabled) {
            border-color: var(--accent);
            background: rgba(240, 180, 41, 0.1);
        }

        .btn-secondary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
        }

        .input {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 0.75rem 1rem;
            color: var(--fg);
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.2s ease;
            width: 100%;
        }

        .input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        /* Mine Grid */
        .mine-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            max-width: 350px;
            margin: 0 auto;
        }

        .mine-cell {
            aspect-ratio: 1;
            background: linear-gradient(145deg, #1e1e2a, #151520);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .mine-cell::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, transparent 50%);
            pointer-events: none;
        }

        .mine-cell:hover:not(.revealed):not(.game-over) {
            border-color: var(--accent);
            transform: scale(1.05);
            box-shadow: 0 0 20px var(--accent-glow);
        }

        .mine-cell.revealed {
            cursor: default;
        }

        .mine-cell.gem {
            background: linear-gradient(145deg, rgba(34, 197, 94, 0.15), rgba(34, 197, 94, 0.05));
            border-color: var(--success);
        }

        .mine-cell.mine {
            background: linear-gradient(145deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
            border-color: var(--danger);
        }

        .mine-cell.game-over {
            pointer-events: none;
        }

        /* Bomb Animation */
        .bomb-icon {
            width: 70%;
            height: 70%;
        }

        @keyframes bombPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes bombExplode {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.8; }
            100% { transform: scale(2); opacity: 0; }
        }

        .bomb-exploding {
            animation: bombExplode 0.4s ease-out forwards;
        }

        @keyframes gemShine {
            0% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
            100% { filter: brightness(1); }
        }

        .gem-shine {
            animation: gemShine 0.5s ease;
        }

        /* Bonus cards */
        .bonus-card {
            background: linear-gradient(145deg, var(--bg-elevated), var(--bg-card));
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .bonus-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .bonus-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--accent), #d4a020);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
        }

        .timer {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.25rem;
            color: var(--accent);
        }

        /* Game cards in games section */
        .game-card {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .game-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(240, 180, 41, 0.1) 0%, transparent 60%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .game-card:hover {
            border-color: var(--accent);
            transform: translateY(-4px);
        }

        .game-card:hover::before {
            opacity: 1;
        }

        .game-card .game-icon {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--accent), #d4a020);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }

        /* Leaderboard */
        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-elevated);
            border-radius: 12px;
            margin-bottom: 0.5rem;
            transition: all 0.2s ease;
        }

        .leaderboard-item:hover {
            background: rgba(240, 180, 41, 0.1);
        }

        .leaderboard-item.current-player {
            border: 1px solid var(--accent);
            background: rgba(240, 180, 41, 0.1);
        }

        .leaderboard-item.top-1 {
            background: linear-gradient(90deg, rgba(240, 180, 41, 0.2), transparent);
            border-left: 3px solid var(--accent);
        }

        .rank {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.875rem;
        }

        .rank-1 { background: linear-gradient(135deg, #f0b429, #d4a020); color: #0a0a0f; }
        .rank-2 { background: linear-gradient(135deg, #94a3b8, #64748b); color: #0a0a0f; }
        .rank-3 { background: linear-gradient(135deg, #c2743a, #a05a2c); color: #fff; }
        .rank-other { background: var(--bg-card); color: var(--muted); }

        .section {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .multiplier {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-8px); }
            40% { transform: translateX(8px); }
            60% { transform: translateX(-4px); }
            80% { transform: translateX(4px); }
        }

        .shake { animation: shake 0.5s ease; }

        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .stat-box {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
        }

        .stat-box.wide {
            grid-column: span 2;
        }

        /* Back button */
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--muted);
            cursor: pointer;
            padding: 0.5rem 0;
            transition: color 0.2s ease;
        }

        .back-btn:hover {
            color: var(--fg);
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--muted);
        }

        @media (max-width: 640px) {
            .nav-item { padding: 0.5rem 0.75rem; font-size: 0.875rem; }
            .mine-grid { max-width: 280px; gap: 6px; }
            .mine-cell { border-radius: 8px; }
            .stats-grid { grid-template-columns: 1fr; }
            .stat-box.wide { grid-column: span 1; }
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    <div class="grid-overlay"></div>

    <!-- Header -->
    <header class="sticky top-0 z-50 backdrop-blur-xl bg-[#0a0a0f]/80 border-b border-[#2a2a3a]">
        <div class="max-w-4xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-[#f0b429] to-[#d4a020] flex items-center justify-center">
                        <span class="text-black font-bold text-sm">m</span>
                    </div>
                    <span class="font-bold text-lg">mCoin</span>
                </div>
                <div class="flex items-center gap-1 bg-[#12121a] rounded-full px-3 py-1 border border-[#2a2a3a]">
                    <svg class="w-4 h-4 text-[#f0b429]" fill="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"/>
                    </svg>
                    <span id="header-balance" class="mono font-bold text-sm">1000.00</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="max-w-4xl mx-auto px-4 py-4">
        <div class="flex justify-center gap-2 flex-wrap">
            <div class="nav-item active" data-section="profile">Профиль</div>
            <div class="nav-item" data-section="bonus">Бонусы</div>
            <div class="nav-item" data-section="games-menu">Игры</div>
            <div class="nav-item" data-section="top">Топ</div>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto px-4 pb-8">
        <!-- Profile Section -->
        <section id="profile" class="section active">
            <div class="card max-w-md mx-auto">
                <div class="flex items-center gap-4 mb-6">
                    <div class="w-20 h-20 rounded-2xl bg-gradient-to-br from-[#f0b429] to-[#d4a020] flex items-center justify-center">
                        <svg class="w-10 h-10 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <p class="text-[#6b6b7a] text-sm mb-1">Добро пожаловать</p>
                        <h2 id="display-nickname" class="text-2xl font-bold">Игрок</h2>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm text-[#6b6b7a] mb-2">Никнейм</label>
                    <div class="flex gap-2">
                        <input type="text" id="nickname-input" class="input" placeholder="Введите никнейм" maxlength="20">
                        <button id="save-nickname" class="btn btn-primary">Сохранить</button>
                    </div>
                </div>

                <div class="bg-[#1a1a25] rounded-xl p-4 mb-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-[#6b6b7a] text-sm mb-1">Ваш баланс</p>
                            <div class="flex items-center gap-2">
                                <svg class="w-6 h-6 text-[#f0b429]" fill="currentColor" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="10"/>
                                </svg>
                                <span id="profile-balance" class="mono text-3xl font-bold">1000.00</span>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-[#6b6b7a] text-sm">mCoin</p>
                        </div>
                    </div>
                </div>

                <div class="border-t border-[#2a2a3a] pt-6">
                    <h3 class="font-bold mb-4">Статистика</h3>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <p class="text-2xl font-bold text-[#22c55e]" id="stats-wins">0</p>
                            <p class="text-sm text-[#6b6b7a]">Побед</p>
                        </div>
                        <div class="stat-box">
                            <p class="text-2xl font-bold text-[#ef4444]" id="stats-losses">0</p>
                            <p class="text-sm text-[#6b6b7a]">Поражений</p>
                        </div>
                        <div class="stat-box">
                            <p class="text-xl font-bold text-[#22c55e]" id="stats-won">+0.00</p>
                            <p class="text-sm text-[#6b6b7a]">Выиграно</p>
                        </div>
                        <div class="stat-box">
                            <p class="text-xl font-bold text-[#ef4444]" id="stats-lost">-0.00</p>
                            <p class="text-sm text-[#6b6b7a]">Проиграно</p>
                        </div>
                        <div class="stat-box wide">
                            <p class="text-2xl font-bold" id="stats-profit">0.00</p>
                            <p class="text-sm text-[#6b6b7a]">Профит</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bonus Section -->
        <section id="bonus" class="section">
            <div class="grid md:grid-cols-2 gap-6 max-w-2xl mx-auto">
                <div class="bonus-card">
                    <div class="bonus-icon">
                        <svg class="w-7 h-7 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Базовый бонус</h3>
                    <p class="text-[#6b6b7a] text-sm mb-4">Раз в час</p>
                    <p class="text-2xl font-bold text-[#22c55e] mb-4">+50 mCoin</p>
                    <p class="timer mb-4" id="hourly-timer">00:00:00</p>
                    <button id="hourly-bonus" class="btn btn-primary w-full">Забрать</button>
                </div>

                <div class="bonus-card">
                    <div class="bonus-icon">
                        <svg class="w-7 h-7 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Ежедневный бонус</h3>
                    <p class="text-[#6b6b7a] text-sm mb-4">Раз в 24 часа</p>
                    <p class="text-2xl font-bold text-[#22c55e] mb-4">+500 mCoin</p>
                    <p class="timer mb-4" id="daily-timer">00:00:00</p>
                    <button id="daily-bonus" class="btn btn-primary w-full">Забрать</button>
                </div>
            </div>
        </section>

        <!-- Games Menu Section -->
        <section id="games-menu" class="section">
            <div class="max-w-md mx-auto">
                <h2 class="text-2xl font-bold mb-6 text-center">Выберите игру</h2>
                <div class="grid gap-4">
                    <div class="game-card" data-game="mines">
                        <div class="game-icon">
                            <svg class="w-8 h-8 text-black" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="8"/>
                                <circle cx="12" cy="12" r="3"/>
                                <line x1="12" y1="2" x2="12" y2="4"/>
                                <line x1="12" y1="20" x2="12" y2="22"/>
                                <line x1="2" y1="12" x2="4" y2="12"/>
                                <line x1="20" y1="12" x2="22" y2="12"/>
                            </svg>
                        </div>
                        <h3 class="font-bold text-lg mb-1">Мины</h3>
                        <p class="text-[#6b6b7a] text-sm">Классическая игра. Открывайте клетки и избегайте мин. Множитель растёт с каждым успешным шагом.</p>
                        <div class="mt-3 flex items-center gap-2 text-[#f0b429] text-sm">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                            </svg>
                            <span>Удачи</span>
                        </div>
                    </div>

                    <!-- Placeholder for future games -->
                    <div class="game-card opacity-50 cursor-not-allowed">
                        <div class="game-icon bg-[#2a2a3a]" style="background: linear-gradient(135deg, #3a3a4a, #2a2a3a);">
                            <svg class="w-8 h-8 text-[#6b6b7a]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                            </svg>
                        </div>
                        <h3 class="font-bold text-lg mb-1 text-[#6b6b7a]">Скоро...</h3>
                        <p class="text-[#6b6b7a] text-sm">Новые игры уже в разработке</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Mines Game Section -->
        <section id="mines-game" class="section">
            <div class="max-w-lg mx-auto">
                <div class="back-btn mb-4" id="back-to-games">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    <span>Назад к играм</span>
                </div>

                <div class="card">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-bold">Мины</h2>
                        <div class="text-right">
                            <p class="text-sm text-[#6b6b7a]">Множитель</p>
                            <p class="multiplier" id="multiplier">1.00x</p>
                        </div>
                    </div>

                    <!-- Game Controls -->
                    <div class="grid grid-cols-2 gap-4 mb-6" id="game-controls">
                        <div>
                            <label class="block text-sm text-[#6b6b7a] mb-2">Ставка</label>
                            <input type="number" id="bet-amount" class="input mono" value="10" min="1" step="1">
                        </div>
                        <div>
                            <label class="block text-sm text-[#6b6b7a] mb-2">Мины (1-24)</label>
                            <input type="number" id="mines-count" class="input mono" value="5" min="1" max="24">
                        </div>
                    </div>

                    <!-- Game Status -->
                    <div class="bg-[#1a1a25] rounded-xl p-3 mb-6 text-center" id="game-status">
                        <p class="text-[#6b6b7a]">Выберите ставку и начните игру</p>
                    </div>

                    <!-- Mine Grid -->
                    <div class="mine-grid mb-6" id="mine-grid"></div>

                    <!-- Game Buttons -->
                    <div class="flex gap-3">
                        <button id="start-game" class="btn btn-primary flex-1">Начать игру</button>
                        <button id="cashout-btn" class="btn btn-secondary flex-1" disabled>Забрать</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Top Section -->
        <section id="top" class="section">
            <div class="card max-w-md mx-auto">
                <h2 class="text-xl font-bold mb-6 text-center">Топ игроков</h2>
                <div id="leaderboard"></div>
            </div>
        </section>
    </main>

    <script>
        // ========== MULTIPLIERS TABLE ==========
        const MULTIPLIERS = {
            1: [1.01,1.05,1.10,1.15,1.21,1.27,1.34,1.42,1.51,1.61,1.73,1.86,2.02,2.20,2.42,2.69,3.03,3.46,4.04,4.85,6.06,8.08,12.12,24.25],
            2: [1.05,1.15,1.26,1.38,1.53,1.70,1.90,2.14,2.42,2.77,3.19,3.73,4.40,5.29,6.46,8.08,10.39,13.85,19.40,29.10,48.50,97.00,291.00],
            3: [1.10,1.26,1.45,1.67,1.95,2.28,2.70,3.23,3.92,4.82,6.03,7.71,10.09,13.56,18.79,27.09,40.94,65.50,114.62,225.58,563.96,2255.83],
            4: [1.15,1.38,1.67,2.05,2.53,3.16,4.00,5.15,6.78,9.14,12.71,18.28,27.42,43.43,73.83,137.55,289.58,723.95,2292.52,11462.58,114625.83],
            5: [1.21,1.53,1.96,2.53,3.32,4.43,6.01,8.33,11.80,17.15,25.73,39.92,64.22,108.38,192.67,368.53,773.91,1934.78,6771.74,50788.04],
            6: [1.27,1.70,2.30,3.16,4.41,6.28,9.15,13.66,20.98,33.31,54.71,93.79,168.83,321.58,663.26,1525.50,4195.12,15382.11,169203.22],
            7: [1.34,1.90,2.73,4.00,5.98,9.16,14.42,23.42,39.26,68.21,123.63,238.16,494.34,1112.27,2780.68,8342.06,34758.58,451861.64],
            8: [1.42,2.14,3.28,5.15,8.33,13.89,23.95,42.75,79.53,154.21,312.43,676.93,1592.78,4247.42,13591.75,61162.88,1039769.00],
            9: [1.51,2.42,3.98,6.74,11.80,21.36,40.23,79.03,162.11,351.24,819.57,2091.13,5924.87,19552.07,83096.31,2077407.00],
            10:[1.61,2.77,4.95,9.29,18.28,37.74,82.11,188.85,464.87,1239.66,3636.33,12121.11,48484.44,266664.42,3199973.00],
            11:[1.73,3.19,6.19,12.71,27.58,63.66,158.45,431.14,1293.41,4526.96,18918.42,104051.34,832410.74,4330500.00],
            12:[1.86,3.73,7.96,18.28,45.71,125.72,384.47,1331.42,5325.71,26628.55,173085.60,1557770.40,5052250.00],
            13:[2.02,4.40,10.13,24.84,66.24,198.74,675.72,2533.95,11402.77,68416.65,615750.00,5052250.00],
            14:[2.20,5.29,13.60,38.25,119.53,418.37,1673.50,8032.81,50205.09,451845.83,4330500.00],
            15:[2.42,6.46,18.59,59.76,215.15,896.48,4333.00,25998.00,207984.00,3175700.00],
            16:[2.69,8.08,26.56,97.40,409.11,2045.55,12273.30,98186.44,1984812.00],
            17:[3.03,10.39,39.84,179.30,986.15,6574.34,55881.93,1047571.00],
            18:[3.46,13.85,63.74,366.52,2748.91,27489.13,465587.00],
            19:[4.04,19.40,111.55,818.04,8589.45,171789.00],
            20:[4.85,29.10,223.10,2454.10,51536.10],
            21:[6.06,48.50,557.75,12270.50],
            22:[8.08,97.00,2231.00],
            23:[12.12,291.00],
            24:[24.25]
        };

        // ========== DATA ==========
        const DEFAULT_DATA = {
            nickname: 'Игрок',
            balance: 1000,
            wins: 0,
            losses: 0,
            totalWon: 0,
            totalLost: 0,
            hourlyBonusTime: 0,
            dailyBonusTime: 0
        };

        // All players storage (for leaderboard)
        let allPlayers = [];
        let gameData = { ...DEFAULT_DATA };

        // ========== GAME STATE ==========
        let gameState = {
            isPlaying: false,
            bet: 0,
            minesCount: 5,
            mines: [],
            revealed: 0,
            multiplier: 1,
            gameOver: false
        };

        // ========== DOM ELEMENTS ==========
        const navItems = document.querySelectorAll('.nav-item');
        const sections = document.querySelectorAll('.section');

        // Profile
        const nicknameInput = document.getElementById('nickname-input');
        const displayNickname = document.getElementById('display-nickname');
        const saveNicknameBtn = document.getElementById('save-nickname');
        const profileBalance = document.getElementById('profile-balance');
        const headerBalance = document.getElementById('header-balance');
        const statsWins = document.getElementById('stats-wins');
        const statsLosses = document.getElementById('stats-losses');
        const statsWon = document.getElementById('stats-won');
        const statsLost = document.getElementById('stats-lost');
        const statsProfit = document.getElementById('stats-profit');

        // Bonus
        const hourlyBonusBtn = document.getElementById('hourly-bonus');
        const dailyBonusBtn = document.getElementById('daily-bonus');
        const hourlyTimer = document.getElementById('hourly-timer');
        const dailyTimer = document.getElementById('daily-timer');

        // Games
        const gameCards = document.querySelectorAll('.game-card[data-game]');
        const backToGamesBtn = document.getElementById('back-to-games');

        // Mines
        const mineGrid = document.getElementById('mine-grid');
        const betAmount = document.getElementById('bet-amount');
        const minesCountInput = document.getElementById('mines-count');
        const startGameBtn = document.getElementById('start-game');
        const cashoutBtn = document.getElementById('cashout-btn');
        const multiplierDisplay = document.getElementById('multiplier');
        const gameStatus = document.getElementById('game-status');

        // ========== FUNCTIONS ==========

        function saveData() {
            localStorage.setItem('mcoin_game', JSON.stringify(gameData));
        }

        function loadData() {
            const saved = localStorage.getItem('mcoin_game');
            if (saved) {
                gameData = { ...DEFAULT_DATA, ...JSON.parse(saved) };
            }
            
            const savedPlayers = localStorage.getItem('mcoin_all_players');
            if (savedPlayers) {
                allPlayers = JSON.parse(savedPlayers);
            }
        }

        function updateUI() {
            displayNickname.textContent = gameData.nickname;
            nicknameInput.value = gameData.nickname;
            profileBalance.textContent = gameData.balance.toFixed(2);
            headerBalance.textContent = gameData.balance.toFixed(2);
            statsWins.textContent = gameData.wins;
            statsLosses.textContent = gameData.losses;
            
            const profit = gameData.totalWon - gameData.totalLost;
            statsWon.textContent = '+' + gameData.totalWon.toFixed(2);
            statsLost.textContent = '-' + gameData.totalLost.toFixed(2);
            statsProfit.textContent = (profit >= 0 ? '+' : '') + profit.toFixed(2);
            statsProfit.style.color = profit >= 0 ? '#22c55e' : '#ef4444';
        }

        function updatePlayerInLeaderboard() {
            const existingIndex = allPlayers.findIndex(p => p.id === 'player');
            if (existingIndex >= 0) {
                allPlayers[existingIndex] = {
                    id: 'player',
                    name: gameData.nickname,
                    balance: gameData.balance
                };
            } else {
                allPlayers.push({
                    id: 'player',
                    name: gameData.nickname,
                    balance: gameData.balance
                });
            }
            localStorage.setItem('mcoin_all_players', JSON.stringify(allPlayers));
        }

        function switchSection(sectionId) {
            navItems.forEach(item => {
                item.classList.toggle('active', item.dataset.section === sectionId);
            });
            sections.forEach(section => {
                section.classList.toggle('active', section.id === sectionId);
            });

            if (sectionId === 'top') {
                renderLeaderboard();
            }
        }

        function formatTime(seconds) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 3600 % 60;
            return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function updateBonusTimers() {
            const now = Math.floor(Date.now() / 1000);
            
            const hourlyRemaining = Math.max(0, gameData.hourlyBonusTime - now);
            hourlyTimer.textContent = formatTime(hourlyRemaining);
            hourlyBonusBtn.disabled = hourlyRemaining > 0;
            hourlyBonusBtn.textContent = hourlyRemaining > 0 ? 'Ждите' : 'Забрать';

            const dailyRemaining = Math.max(0, gameData.dailyBonusTime - now);
            dailyTimer.textContent = formatTime(dailyRemaining);
            dailyBonusBtn.disabled = dailyRemaining > 0;
            dailyBonusBtn.textContent = dailyRemaining > 0 ? 'Ждите' : 'Забрать';
        }

        function claimHourlyBonus() {
            const now = Math.floor(Date.now() / 1000);
            if (now >= gameData.hourlyBonusTime) {
                gameData.balance += 50;
                gameData.hourlyBonusTime = now + 3600;
                saveData();
                updateUI();
                updatePlayerInLeaderboard();
                updateBonusTimers();
                showNotification('+50 mCoin', 'success');
            }
        }

        function claimDailyBonus() {
            const now = Math.floor(Date.now() / 1000);
            if (now >= gameData.dailyBonusTime) {
                gameData.balance += 500;
                gameData.dailyBonusTime = now + 86400;
                saveData();
                updateUI();
                updatePlayerInLeaderboard();
                updateBonusTimers();
                showNotification('+500 mCoin', 'success');
            }
        }

        function showNotification(message, type) {
            const colors = {
                success: 'bg-[#22c55e]',
                error: 'bg-[#ef4444]',
                info: 'bg-[#f0b429]'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-20 left-1/2 -translate-x-1/2 ${colors[type]} text-black px-6 py-3 rounded-xl font-bold z-50`;
            notification.textContent = message;
            notification.style.animation = 'fadeIn 0.3s ease';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        // ========== MINES GAME ==========

        function createGrid() {
            mineGrid.innerHTML = '';
            for (let i = 0; i < 25; i++) {
                const cell = document.createElement('div');
                cell.className = 'mine-cell';
                cell.dataset.index = i;
                mineGrid.appendChild(cell);
            }
        }

        function getMultiplier(mines, revealed) {
            if (revealed === 0) return 1;
            const arr = MULTIPLIERS[mines];
            if (!arr || revealed > arr.length) return 1;
            return arr[revealed - 1];
        }

        function createBombSVG() {
            return `
                <svg class="bomb-icon" viewBox="0 0 100 100" fill="none">
                    <!-- Bomb body -->
                    <circle cx="50" cy="55" r="35" fill="#1a1a1a" stroke="#333" stroke-width="2"/>
                    <circle cx="50" cy="55" r="30" fill="url(#bombGradient)"/>
                    
                    <!-- Highlight -->
                    <ellipse cx="40" cy="45" rx="12" ry="8" fill="rgba(255,255,255,0.15)"/>
                    
                    <!-- Fuse -->
                    <path d="M50 20 Q55 10 65 15 Q75 20 70 10" stroke="#8B4513" stroke-width="4" fill="none" stroke-linecap="round"/>
                    
                    <!-- Spark -->
                    <circle cx="70" cy="10" r="5" fill="#f97316">
                        <animate attributeName="r" values="3;6;3" dur="0.3s" repeatCount="indefinite"/>
                        <animate attributeName="opacity" values="1;0.5;1" dur="0.3s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="70" cy="10" r="8" fill="#fbbf24" opacity="0.5">
                        <animate attributeName="r" values="5;10;5" dur="0.3s" repeatCount="indefinite"/>
                    </circle>
                    
                    <!-- Skull -->
                    <ellipse cx="50" cy="55" rx="15" ry="12" fill="#333"/>
                    <circle cx="44" cy="52" r="4" fill="#1a1a1a"/>
                    <circle cx="56" cy="52" r="4" fill="#1a1a1a"/>
                    <path d="M46 62 L50 58 L54 62" stroke="#1a1a1a" stroke-width="2" fill="none"/>
                    
                    <defs>
                        <radialGradient id="bombGradient" cx="30%" cy="30%">
                            <stop offset="0%" stop-color="#4a4a4a"/>
                            <stop offset="100%" stop-color="#1a1a1a"/>
                        </radialGradient>
                    </defs>
                </svg>
            `;
        }

        function createGemSVG() {
            return `
                <svg class="w-8 h-8" viewBox="0 0 24 24" fill="none">
                    <polygon points="12,2 22,9 18,22 6,22 2,9" fill="url(#gemGrad)" stroke="#22c55e" stroke-width="1"/>
                    <polygon points="12,2 22,9 12,14 2,9" fill="#4ade80" opacity="0.5"/>
                    <polygon points="12,14 18,22 6,22" fill="#166534"/>
                    <defs>
                        <linearGradient id="gemGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#4ade80"/>
                            <stop offset="100%" stop-color="#22c55e"/>
                        </linearGradient>
                    </defs>
                </svg>
            `;
        }

        function startGame() {
            const bet = parseFloat(betAmount.value);
            const mines = parseInt(minesCountInput.value);

            if (isNaN(bet) || bet < 1) {
                showNotification('Введите корректную ставку', 'error');
                return;
            }

            if (bet > gameData.balance) {
                showNotification('Недостаточно средств', 'error');
                return;
            }

            if (isNaN(mines) || mines < 1 || mines > 24) {
                showNotification('Количество мин: 1-24', 'error');
                return;
            }

            gameData.balance -= bet;
            updateUI();
            saveData();

            gameState = {
                isPlaying: true,
                bet: bet,
                minesCount: mines,
                mines: [],
                revealed: 0,
                multiplier: 1,
                gameOver: false
            };

            const positions = [];
            while (positions.length < mines) {
                const pos = Math.floor(Math.random() * 25);
                if (!positions.includes(pos)) {
                    positions.push(pos);
                }
            }
            gameState.mines = positions;

            createGrid();
            multiplierDisplay.textContent = '1.00x';
            gameStatus.innerHTML = `<p class="text-[#f0b429]">Игра началась! Открывайте клетки</p>`;
            startGameBtn.disabled = true;
            cashoutBtn.disabled = true;
            betAmount.disabled = true;
            minesCountInput.disabled = true;

            document.querySelectorAll('.mine-cell').forEach(cell => {
                cell.addEventListener('click', handleCellClick);
            });
        }

        function handleCellClick(e) {
            if (!gameState.isPlaying || gameState.gameOver) return;
            
            const cell = e.target.closest('.mine-cell');
            if (!cell) return;
            
            const index = parseInt(cell.dataset.index);

            if (cell.classList.contains('revealed')) return;

            cell.classList.add('revealed');

            if (gameState.mines.includes(index)) {
                cell.classList.add('mine');
                cell.innerHTML = createBombSVG();
                endGame(false);
            } else {
                cell.classList.add('gem');
                cell.innerHTML = createGemSVG();
                cell.querySelector('svg').classList.add('gem-shine');
                
                gameState.revealed++;
                gameState.multiplier = getMultiplier(gameState.minesCount, gameState.revealed);
                multiplierDisplay.textContent = gameState.multiplier.toFixed(2) + 'x';
                
                cashoutBtn.disabled = false;

                if (gameState.revealed >= 25 - gameState.minesCount) {
                    endGame(true);
                }
            }
        }

        function endGame(won) {
            gameState.gameOver = true;
            gameState.isPlaying = false;

            document.querySelectorAll('.mine-cell').forEach((cell, i) => {
                cell.classList.add('game-over');
                if (gameState.mines.includes(i) && !cell.classList.contains('mine')) {
                    cell.classList.add('mine');
                    cell.innerHTML = createBombSVG();
                }
            });

            if (won) {
                const winnings = gameState.bet * gameState.multiplier;
                gameData.balance += winnings;
                gameData.wins++;
                gameData.totalWon += winnings;
                gameStatus.innerHTML = `<p class="text-[#22c55e]">Победа! +${winnings.toFixed(2)} mCoin</p>`;
                showNotification(`+${winnings.toFixed(2)} mCoin`, 'success');
            } else {
                gameData.losses++;
                gameData.totalLost += gameState.bet;
                gameStatus.innerHTML = `<p class="text-[#ef4444]">БАБАХ! Вы попали на мину!</p>`;
                mineGrid.classList.add('shake');
                setTimeout(() => mineGrid.classList.remove('shake'), 500);
            }

            updateUI();
            updatePlayerInLeaderboard();
            saveData();

            startGameBtn.disabled = false;
            cashoutBtn.disabled = true;
            betAmount.disabled = false;
            minesCountInput.disabled = false;
        }

        function cashout() {
            if (!gameState.isPlaying || gameState.gameOver || gameState.revealed === 0) return;

            const winnings = gameState.bet * gameState.multiplier;
            gameData.balance += winnings;
            gameData.wins++;
            gameData.totalWon += winnings;
            
            gameState.gameOver = true;
            gameState.isPlaying = false;

            document.querySelectorAll('.mine-cell').forEach((cell, i) => {
                cell.classList.add('game-over');
                if (gameState.mines.includes(i)) {
                    cell.classList.add('mine');
                    cell.innerHTML = createBombSVG();
                }
            });

            gameStatus.innerHTML = `<p class="text-[#22c55e]">Вы забрали +${winnings.toFixed(2)} mCoin</p>`;
            showNotification(`+${winnings.toFixed(2)} mCoin`, 'success');

            updateUI();
            updatePlayerInLeaderboard();
            saveData();

            startGameBtn.disabled = false;
            cashoutBtn.disabled = true;
            betAmount.disabled = false;
            minesCountInput.disabled = false;
        }

        // Leaderboard - only real players
        function renderLeaderboard() {
            const leaderboard = document.getElementById('leaderboard');
            
            if (allPlayers.length === 0) {
                leaderboard.innerHTML = `
                    <div class="empty-state">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-30" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        <p>Пока нет игроков в рейтинге</p>
                        <p class="text-sm mt-2">Играйте и попадите в топ!</p>
                    </div>
                `;
                return;
            }

            const sorted = [...allPlayers].sort((a, b) => b.balance - a.balance);

            leaderboard.innerHTML = sorted.map((player, index) => {
                const rankClass = index === 0 ? 'rank-1' : index === 1 ? 'rank-2' : index === 2 ? 'rank-3' : 'rank-other';
                const topClass = index === 0 ? 'top-1' : '';
                const isPlayer = player.id === 'player';
                const playerClass = isPlayer ? 'current-player' : '';
                
                return `
                    <div class="leaderboard-item ${topClass} ${playerClass}">
                        <div class="rank ${rankClass}">${index + 1}</div>
                        <div class="flex-1">
                            <p class="font-medium">${player.name}${isPlayer ? ' (Вы)' : ''}</p>
                        </div>
                        <div class="flex items-center gap-1">
                            <svg class="w-4 h-4 text-[#f0b429]" fill="currentColor" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10"/>
                            </svg>
                            <span class="mono font-bold">${player.balance.toLocaleString()}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ========== EVENT LISTENERS ==========

        navItems.forEach(item => {
            item.addEventListener('click', () => switchSection(item.dataset.section));
        });

        saveNicknameBtn.addEventListener('click', () => {
            const nickname = nicknameInput.value.trim();
            if (nickname.length > 0) {
                gameData.nickname = nickname;
                updatePlayerInLeaderboard();
                saveData();
                updateUI();
                showNotification('Никнейм сохранён', 'success');
            }
        });

        hourlyBonusBtn.addEventListener('click', claimHourlyBonus);
        dailyBonusBtn.addEventListener('click', claimDailyBonus);

        gameCards.forEach(card => {
            card.addEventListener('click', () => {
                const game = card.dataset.game;
                if (game === 'mines') {
                    switchSection('mines-game');
                }
            });
        });

        backToGamesBtn.addEventListener('click', () => {
            switchSection('games-menu');
        });

        startGameBtn.addEventListener('click', startGame);
        cashoutBtn.addEventListener('click', cashout);

        // ========== INIT ==========
        function init() {
            loadData();
            updateUI();
            createGrid();
            updateBonusTimers();
            updatePlayerInLeaderboard();
            setInterval(updateBonusTimers, 1000);
        }

        init();
    </script>
</body>
</html>

